name: Generate Onion Address

on:
  workflow_dispatch:  # ØªØ´ØºÙŠÙ„ ÙŠØ¯ÙˆÙŠ

jobs:
  generate-onion:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ› ï¸ ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø¨ÙŠØ¦Ø©
        run: |
          sudo apt update && sudo apt install -y git make gcc autoconf automake libsodium-dev

      - name: ğŸ”½ ØªÙ†Ø²ÙŠÙ„ `mkp224o`
        run: |
          git clone --recursive https://github.com/cathugger/mkp224o.git
          cd mkp224o
          autoreconf -i
          ./configure
          make

      - name: ğŸ¯ ØªØ´ØºÙŠÙ„ `mkp224o` Ù„ØªÙˆÙ„ÙŠØ¯ Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ø­Ø¯ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ "dienet"
        run: |
          cd mkp224o
          ./mkp224o dienet -d output -n 1  # ØªÙˆÙ„ÙŠØ¯ Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·

      - name: ğŸ“‚ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
        run: ls -la mkp224o/output

      - name: ğŸ“¤ Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø®Ø§Øµ ÙƒÙ€ Artifact
        uses: actions/upload-artifact@v4
        with:
          name: dienet-onion-key
          path: mkp224o/output/dienet*
